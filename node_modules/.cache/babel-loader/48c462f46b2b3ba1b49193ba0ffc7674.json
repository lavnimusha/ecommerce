{"ast":null,"code":"import _toConsumableArray from\"/Users/lavanyagurajada/enguyen/ecommerce/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/Users/lavanyagurajada/enguyen/ecommerce/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from'react';import Box from'@mui/material/Box';import Grid from'@mui/material/Grid';import CartCard from'../Components/CartCard';import Divider from'@mui/material/Divider';import Paper from'@mui/material/Paper';import Typography from'@mui/material/Typography';import Button from'@mui/material/Button';import{useContext}from'react';/* import {CartContext} from '../App' */import{CartContext}from'../Components/CartDataContext';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Cart(){var _useState=useState(0),_useState2=_slicedToArray(_useState,2),cartCount=_useState2[0],setCartCount=_useState2[1];var _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),inventory=_useState4[0],setInventory=_useState4[1];/* const setCartContext = useContext(CartContext) */var _useContext=useContext(CartContext),cart=_useContext.cart;/* \n  useEffect(() => {\n    // Update the document title using the browser API\n    const starCountRef = ref(database, 'shopping/');\n    onValue(starCountRef, (snapshot) => {\n      const data = snapshot.val();\n      setCart(data)\n      \n    });\n    \n  },[]) */useEffect(function(){var obj={};Object.entries(cart).forEach(func);function func(value){if(!obj.hasOwnProperty(value[1].title))obj[value[1].title]={picture:value[1].picture,entries:[value[0]],price:value[1].price,count:1};else{var arr=_toConsumableArray(obj[value[1].title].entries);arr.push(value[0]);arr=_toConsumableArray(removeDuplicates(arr));obj[value[1].title].entries=_toConsumableArray(arr);obj[value[1].title].count+=1;}}function removeDuplicates(entryArr){for(var i=0;i<entryArr.length;i++){if(entryArr.lastIndexOf(entryArr[i])!=i){entryArr.splice(entryArr.lastIndexOf(entryArr[i]),1);}}return entryArr;}setInventory(obj);//total count of items in cart\nsetCartCount(Object.keys(cart).length);},[cart]);var handleProceedToPay=function handleProceedToPay(e){//e.preventDefault()\nfetch(\"http://localhost:4242/create-checkout-session\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(inventory)}).then(function(res){if(res.ok)return res.json();return res.json().then(function(json){return Promise.reject(json);});}).then(function(_ref){var url=_ref.url;console.log(url);window.location=url;}).catch(function(e){console.error(e.error);});};return/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',flexGrow:1},children:[/*#__PURE__*/_jsx(Grid,{container:true,children:Object.entries(inventory).map(function(data,index){return/*#__PURE__*/_jsxs(Grid,{item:true,sx:{width:\"90%\"},children:[/*#__PURE__*/_jsx(CartCard,{entries:data[1].entries,title:data[0],picture:data[1].picture,price:data[1].price,count:data[1].count}),/*#__PURE__*/_jsx(Divider,{})]},index);})}),/*#__PURE__*/_jsx(Paper,{sx:{position:'fixed',bottom:0,left:0,right:0},elevation:3,children:/*#__PURE__*/_jsxs(Box,{sx:{display:\"flex\",flexDirection:\"row\",justifyContent:\"space-between\",p:2,ml:8,mr:8},children:[/*#__PURE__*/_jsx(Box,{children:/*#__PURE__*/_jsxs(Typography,{variant:\"h5\",sx:{fontWeight:\"550\"},children:[\"Total: \",cartCount]})}),/*#__PURE__*/_jsx(Box,{children:/*#__PURE__*/_jsx(Button,{color:\"primary\",variant:\"contained\",onClick:function onClick(e){handleProceedToPay(e);},children:\"Proceed to Pay\"})})]})})]});}export default Cart;","map":{"version":3,"names":["React","useEffect","useState","Box","Grid","CartCard","Divider","Paper","Typography","Button","useContext","CartContext","Cart","cartCount","setCartCount","inventory","setInventory","cart","obj","Object","entries","forEach","func","value","hasOwnProperty","title","picture","price","count","arr","push","removeDuplicates","entryArr","i","length","lastIndexOf","splice","keys","handleProceedToPay","e","fetch","method","headers","body","JSON","stringify","then","res","ok","json","Promise","reject","url","console","log","window","location","catch","error","display","flexGrow","map","data","index","width","position","bottom","left","right","flexDirection","justifyContent","p","ml","mr","fontWeight"],"sources":["/Users/lavanyagurajada/enguyen/ecommerce/src/Pages/Cart.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react'\nimport {database} from \"../firebase-config\"\nimport { getDatabase, ref, onValue} from \"firebase/database\";\nimport Box from '@mui/material/Box';\nimport Grid from '@mui/material/Grid';\nimport CartCard from '../Components/CartCard'\nimport Divider from '@mui/material/Divider';\nimport Paper from '@mui/material/Paper';\nimport Typography from '@mui/material/Typography';\nimport Button from '@mui/material/Button';\nimport { useContext } from 'react'\n/* import {CartContext} from '../App' */\nimport {CartContext} from '../Components/CartDataContext'\n\ninterface Inventory {\n  picture: string,\n  entries: string[],\n  price: string,\n  count: number\n}\ninterface InventoryEntry{\n  [title:string]: Inventory\n}\ninterface Product  {\n  picture: string,\n  title: string,\n  price: string\n}\ninterface ProductEntry {\n  [key:string]: Product\n}\n\n\nfunction Cart() {\n  const [cartCount, setCartCount] =  useState<number>(0)\n  const [inventory, setInventory] =  useState<InventoryEntry>({})\n  /* const setCartContext = useContext(CartContext) */\n  const {cart} = useContext(CartContext)\n/* \n  useEffect(() => {\n    // Update the document title using the browser API\n    const starCountRef = ref(database, 'shopping/');\n    onValue(starCountRef, (snapshot) => {\n      const data = snapshot.val();\n      setCart(data)\n      \n    });\n    \n  },[]) */\n\n  useEffect(() => {\n      \n      let obj: InventoryEntry = {}\n      Object.entries(cart).forEach(func)\n\n      function func(value: [string, Product]){\n        \n         if(!obj.hasOwnProperty(value[1].title))\n          obj[value[1].title] = {\n            picture: value[1].picture,\n            entries: [value[0]],\n            price: value[1].price,\n            count: 1\n          }\n          else{\n            let arr :string[] = [...obj[value[1].title].entries] \n            arr.push(value[0])\n            arr = [...removeDuplicates(arr)]\n            obj[value[1].title].entries = [...arr];\n            (obj[value[1].title]).count += 1; \n            }\n          } \n          function removeDuplicates(entryArr :string[]){\n              for( let i = 0; i < entryArr.length; i++){\n                  if(entryArr.lastIndexOf(entryArr[i]) != i ){\n                        entryArr.splice(entryArr.lastIndexOf(entryArr[i]), 1)      \n                  }\n              }\n              return entryArr\n          }\n          setInventory(obj)\n\n          //total count of items in cart\n          setCartCount(Object.keys(cart).length)\n     \n  },[cart]);\n\n  const handleProceedToPay = (e: object) => {\n      //e.preventDefault()\n      fetch(\"http://localhost:4242/create-checkout-session\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify(inventory),\n      })\n        .then(res => {\n          if (res.ok) return res.json()\n          return res.json().then(json => Promise.reject(json))\n        })\n        .then(({ url }) => {\n            console.log(url)\n          window.location = url \n        })\n        .catch(e => {\n          console.error(e.error)\n        })\n  }\n\n  return (\n    <Box sx={{ display: 'flex', flexGrow: 1 }}>\n      \n       <Grid container >\n        {Object.entries(inventory).map((data, index) => (\n          <Grid item sx={{width: \"90%\"}} key={index}>\n              <CartCard entries={data[1].entries} title={data[0]} picture={data[1].picture}  price={data[1].price} count={data[1].count}/>  \n            <Divider />\n          </Grid>\n        ))}\n      </Grid> \n      <Paper sx={{ position: 'fixed', bottom: 0, left: 0, right: 0 }} elevation={3}>\n        <Box sx={{display: \"flex\", flexDirection: \"row\", justifyContent:\"space-between\", p: 2, ml: 8, mr: 8}}>\n            <Box >\n              <Typography variant=\"h5\" sx={{fontWeight: \"550\"}} >Total: {cartCount}</Typography>\n            </Box>\n            <Box>\n              <Button color=\"primary\" variant=\"contained\" onClick={(e)=>{handleProceedToPay(e)}}>Proceed to Pay</Button>\n            </Box>\n        </Box>\n        \n      </Paper>\n    </Box>\n  )\n}\n\nexport default Cart"],"mappings":"oQAAA,MAAOA,MAAP,EAAgBC,SAAhB,CAA2BC,QAA3B,KAA2C,OAA3C,CAGA,MAAOC,IAAP,KAAgB,mBAAhB,CACA,MAAOC,KAAP,KAAiB,oBAAjB,CACA,MAAOC,SAAP,KAAqB,wBAArB,CACA,MAAOC,QAAP,KAAoB,uBAApB,CACA,MAAOC,MAAP,KAAkB,qBAAlB,CACA,MAAOC,WAAP,KAAuB,0BAAvB,CACA,MAAOC,OAAP,KAAmB,sBAAnB,CACA,OAASC,UAAT,KAA2B,OAA3B,CACA,wCACA,OAAQC,WAAR,KAA0B,+BAA1B,C,wFAqBA,QAASC,KAAT,EAAgB,CACd,cAAmCV,QAAQ,CAAS,CAAT,CAA3C,wCAAOW,SAAP,eAAkBC,YAAlB,eACA,eAAmCZ,QAAQ,CAAiB,EAAjB,CAA3C,yCAAOa,SAAP,eAAkBC,YAAlB,eACA,oDACA,gBAAeN,UAAU,CAACC,WAAD,CAAzB,CAAOM,IAAP,aAAOA,IAAP,CACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAEEhB,SAAS,CAAC,UAAM,CAEZ,GAAIiB,IAAmB,CAAG,EAA1B,CACAC,MAAM,CAACC,OAAP,CAAeH,IAAf,EAAqBI,OAArB,CAA6BC,IAA7B,EAEA,QAASA,KAAT,CAAcC,KAAd,CAAuC,CAEpC,GAAG,CAACL,GAAG,CAACM,cAAJ,CAAmBD,KAAK,CAAC,CAAD,CAAL,CAASE,KAA5B,CAAJ,CACCP,GAAG,CAACK,KAAK,CAAC,CAAD,CAAL,CAASE,KAAV,CAAH,CAAsB,CACpBC,OAAO,CAAEH,KAAK,CAAC,CAAD,CAAL,CAASG,OADE,CAEpBN,OAAO,CAAE,CAACG,KAAK,CAAC,CAAD,CAAN,CAFW,CAGpBI,KAAK,CAAEJ,KAAK,CAAC,CAAD,CAAL,CAASI,KAHI,CAIpBC,KAAK,CAAE,CAJa,CAAtB,CADD,IAOK,CACF,GAAIC,IAAa,oBAAOX,GAAG,CAACK,KAAK,CAAC,CAAD,CAAL,CAASE,KAAV,CAAH,CAAoBL,OAA3B,CAAjB,CACAS,GAAG,CAACC,IAAJ,CAASP,KAAK,CAAC,CAAD,CAAd,EACAM,GAAG,oBAAOE,gBAAgB,CAACF,GAAD,CAAvB,CAAH,CACAX,GAAG,CAACK,KAAK,CAAC,CAAD,CAAL,CAASE,KAAV,CAAH,CAAoBL,OAApB,oBAAkCS,GAAlC,EACCX,GAAG,CAACK,KAAK,CAAC,CAAD,CAAL,CAASE,KAAV,CAAJ,CAAsBG,KAAtB,EAA+B,CAA/B,CACC,CACF,CACD,QAASG,iBAAT,CAA0BC,QAA1B,CAA6C,CACzC,IAAK,GAAIC,EAAC,CAAG,CAAb,CAAgBA,CAAC,CAAGD,QAAQ,CAACE,MAA7B,CAAqCD,CAAC,EAAtC,CAAyC,CACrC,GAAGD,QAAQ,CAACG,WAAT,CAAqBH,QAAQ,CAACC,CAAD,CAA7B,GAAqCA,CAAxC,CAA2C,CACrCD,QAAQ,CAACI,MAAT,CAAgBJ,QAAQ,CAACG,WAAT,CAAqBH,QAAQ,CAACC,CAAD,CAA7B,CAAhB,CAAmD,CAAnD,EACL,CACJ,CACD,MAAOD,SAAP,CACH,CACDhB,YAAY,CAACE,GAAD,CAAZ,CAEA;AACAJ,YAAY,CAACK,MAAM,CAACkB,IAAP,CAAYpB,IAAZ,EAAkBiB,MAAnB,CAAZ,CAEP,CAnCQ,CAmCP,CAACjB,IAAD,CAnCO,CAAT,CAqCA,GAAMqB,mBAAkB,CAAG,QAArBA,mBAAqB,CAACC,CAAD,CAAe,CACtC;AACAC,KAAK,CAAC,+CAAD,CAAkD,CACrDC,MAAM,CAAE,MAD6C,CAErDC,OAAO,CAAE,CACP,eAAgB,kBADT,CAF4C,CAKrDC,IAAI,CAAEC,IAAI,CAACC,SAAL,CAAe9B,SAAf,CAL+C,CAAlD,CAAL,CAOG+B,IAPH,CAOQ,SAAAC,GAAG,CAAI,CACX,GAAIA,GAAG,CAACC,EAAR,CAAY,MAAOD,IAAG,CAACE,IAAJ,EAAP,CACZ,MAAOF,IAAG,CAACE,IAAJ,GAAWH,IAAX,CAAgB,SAAAG,IAAI,QAAIC,QAAO,CAACC,MAAR,CAAeF,IAAf,CAAJ,EAApB,CAAP,CACD,CAVH,EAWGH,IAXH,CAWQ,cAAa,IAAVM,IAAU,MAAVA,GAAU,CACfC,OAAO,CAACC,GAAR,CAAYF,GAAZ,EACFG,MAAM,CAACC,QAAP,CAAkBJ,GAAlB,CACD,CAdH,EAeGK,KAfH,CAeS,SAAAlB,CAAC,CAAI,CACVc,OAAO,CAACK,KAAR,CAAcnB,CAAC,CAACmB,KAAhB,EACD,CAjBH,EAkBH,CApBD,CAsBA,mBACE,MAAC,GAAD,EAAK,EAAE,CAAE,CAAEC,OAAO,CAAE,MAAX,CAAmBC,QAAQ,CAAE,CAA7B,CAAT,wBAEG,KAAC,IAAD,EAAM,SAAS,KAAf,UACEzC,MAAM,CAACC,OAAP,CAAeL,SAAf,EAA0B8C,GAA1B,CAA8B,SAACC,IAAD,CAAOC,KAAP,qBAC7B,MAAC,IAAD,EAAM,IAAI,KAAV,CAAW,EAAE,CAAE,CAACC,KAAK,CAAE,KAAR,CAAf,wBACI,KAAC,QAAD,EAAU,OAAO,CAAEF,IAAI,CAAC,CAAD,CAAJ,CAAQ1C,OAA3B,CAAoC,KAAK,CAAE0C,IAAI,CAAC,CAAD,CAA/C,CAAoD,OAAO,CAAEA,IAAI,CAAC,CAAD,CAAJ,CAAQpC,OAArE,CAA+E,KAAK,CAAEoC,IAAI,CAAC,CAAD,CAAJ,CAAQnC,KAA9F,CAAqG,KAAK,CAAEmC,IAAI,CAAC,CAAD,CAAJ,CAAQlC,KAApH,EADJ,cAEE,KAAC,OAAD,IAFF,GAAoCmC,KAApC,CAD6B,EAA9B,CADF,EAFH,cAUE,KAAC,KAAD,EAAO,EAAE,CAAE,CAAEE,QAAQ,CAAE,OAAZ,CAAqBC,MAAM,CAAE,CAA7B,CAAgCC,IAAI,CAAE,CAAtC,CAAyCC,KAAK,CAAE,CAAhD,CAAX,CAAgE,SAAS,CAAE,CAA3E,uBACE,MAAC,GAAD,EAAK,EAAE,CAAE,CAACT,OAAO,CAAE,MAAV,CAAkBU,aAAa,CAAE,KAAjC,CAAwCC,cAAc,CAAC,eAAvD,CAAwEC,CAAC,CAAE,CAA3E,CAA8EC,EAAE,CAAE,CAAlF,CAAqFC,EAAE,CAAE,CAAzF,CAAT,wBACI,KAAC,GAAD,wBACE,MAAC,UAAD,EAAY,OAAO,CAAC,IAApB,CAAyB,EAAE,CAAE,CAACC,UAAU,CAAE,KAAb,CAA7B,qBAA2D7D,SAA3D,GADF,EADJ,cAII,KAAC,GAAD,wBACE,KAAC,MAAD,EAAQ,KAAK,CAAC,SAAd,CAAwB,OAAO,CAAC,WAAhC,CAA4C,OAAO,CAAE,iBAAC0B,CAAD,CAAK,CAACD,kBAAkB,CAACC,CAAD,CAAlB,CAAsB,CAAjF,4BADF,EAJJ,GADF,EAVF,GADF,CAwBD,CAED,cAAe3B,KAAf"},"metadata":{},"sourceType":"module"}